<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Gigi Sung’s Workspace</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-EPVTNRSWSE"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-EPVTNRSWSE', { 'anonymize_ip': true});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Gigi Sung’s Workspace</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About me</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Projects/index.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Posts/index.html"> 
<span class="menu-text">Research Log</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Doodling/index.html"> 
<span class="menu-text">Doodling</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="../../Posts/index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools tools-wide">
    <a href="https://github.com/gigisung0503/" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
    <a href="https://linkedin.com/in/gigisung" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-linkedin"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../Policy Analysis/index.html">Public Policy Analytics: A Blog Series</a></li><li class="breadcrumb-item"><a href="../../Policy Analysis/Chapter1/TOD.html">Chapter 1: TOD</a></li><li class="breadcrumb-item"><a href="../../Policy Analysis/Chapter1/TOD.html">Chapter 1: Indicators for Transit-Oriented Development (TOD)</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../Policy Analysis/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Public Policy Analytics: A Blog Series</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Chapter 1: TOD</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Policy Analysis/Chapter1/TOD.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Chapter 1: Indicators for Transit-Oriented Development (TOD)</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
 <span class="menu-text">Chapter 2: Energy</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Policy Analysis/Chapter2/energy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">energy.html</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Policy Analysis/Chapter2/reference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Chapter 3: Land Use</span></span>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Chapter 4: Housing</span></span>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Chapter 5: Climate</span></span>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#why-start-with-indicators" id="toc-why-start-with-indicators" class="nav-link active" data-scroll-target="#why-start-with-indicators">1.1 Why Start With Indicators?</a>
  <ul class="collapse">
  <li><a href="#mapping-scale-bias-in-areal-aggregate-data" id="toc-mapping-scale-bias-in-areal-aggregate-data" class="nav-link" data-scroll-target="#mapping-scale-bias-in-areal-aggregate-data">1.1.1 Mapping &amp; scale bias in areal aggregate data</a></li>
  </ul></li>
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup">1.2 Setup</a>
  <ul class="collapse">
  <li><a href="#census-data-download-and-wrangle" id="toc-census-data-download-and-wrangle" class="nav-link" data-scroll-target="#census-data-download-and-wrangle">1.2.1 Census Data: Download and Wrangle</a></li>
  <li><a href="#transit-open-data-download-and-wrangle" id="toc-transit-open-data-download-and-wrangle" class="nav-link" data-scroll-target="#transit-open-data-download-and-wrangle">1.2.2 Transit Open Data: Download and Wrangle</a></li>
  <li><a href="#relating-tracts-subway-stops-in-space" id="toc-relating-tracts-subway-stops-in-space" class="nav-link" data-scroll-target="#relating-tracts-subway-stops-in-space">1.2.3 Relating Tracts &amp; Subway Stops in Space</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/gigisung0503/gigisung0503.github.io.git/blob/main/Policy Analysis/Chapter1/TOD.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../Policy Analysis/index.html">Public Policy Analytics: A Blog Series</a></li><li class="breadcrumb-item"><a href="../../Policy Analysis/Chapter1/TOD.html">Chapter 1: TOD</a></li><li class="breadcrumb-item"><a href="../../Policy Analysis/Chapter1/TOD.html">Chapter 1: Indicators for Transit-Oriented Development (TOD)</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Chapter 1: Indicators for Transit-Oriented Development (TOD)</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="why-start-with-indicators" class="level2">
<h2 class="anchored" data-anchor-id="why-start-with-indicators">1.1 Why Start With Indicators?</h2>
<ul>
<li><strong>Summary:</strong> Indicators provide simple insights into complex phenomena and are critical for conveying nuanced context to non-technical audiences. Good indicators are relatable, simple, relative, and generate more questions than answers.</li>
</ul>
<section id="mapping-scale-bias-in-areal-aggregate-data" class="level3">
<h3 class="anchored" data-anchor-id="mapping-scale-bias-in-areal-aggregate-data">1.1.1 Mapping &amp; scale bias in areal aggregate data</h3>
<ul>
<li><p>Data Visualization as a Communication Tool: Data visualization is crucial for data scientists as it can convey complex information effectively. However, visualizations, especially maps, can sometimes be misleading.</p></li>
<li><p>Influence of Color on Map Narratives: The way colors are assigned to data on a map can significantly affect the narrative. For example, mapping median household income in Philadelphia shows increased incomes in Center City, but this perception is partly influenced by the color scheme used.</p></li>
<li><p><strong>Map Breaks and Distribution</strong>: Different approaches to setting map breaks, such as equal interval breaks and quintile breaks,* can alter the narrative of a map.* Quintile breaks, which divide data into five equal parts, can provide a clearer contrast in income distribution across the city compared to equal interval breaks.</p></li>
<li><p><strong>Ecological Fallacy and Scale Bias</strong>: Using summary statistics like mean or median to represent individual data points can lead to ecological fallacy <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. This bias occurs when conclusions about individual behavior are drawn from aggregate data. The assumption that a census tract represents a homogeneous neighborhood can further exacerbate this bias.</p></li>
<li><p><strong>Modifiable Areal Unit Problem (MAUP)</strong>: The MAUP refers to the bias introduced when data is aggregated into arbitrarily defined spatial units, such as census tracts. This can lead to misleading interpretations of the data.</p></li>
<li><p><strong>Consideration of Scale Bias</strong>: Scale bias is a critical factor to consider when creating and interpreting indicators. While it’s challenging to eliminate scale bias entirely, acknowledging and understanding its impact is essential for producing useful analytics.</p></li>
</ul>
</section>
</section>
<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">1.2 Setup</h2>
<ul>
<li><strong>Python Libraries:</strong> For this analysis, we will use <code>pandas</code> for data manipulation, <code>geopandas</code> for spatial data handling, <code>matplotlib</code> and <code>seaborn</code> for visualization, and <code>cenpy</code> for accessing Census data.</li>
</ul>
<div id="45e99e6b" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geopandas <span class="im">as</span> gpd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cenpy <span class="im">as</span> cp</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cenpy.tiger <span class="im">as</span> tiger</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="census-data-download-and-wrangle" class="level3">
<h3 class="anchored" data-anchor-id="census-data-download-and-wrangle">1.2.1 Census Data: Download and Wrangle</h3>
<p><strong>Accessing Census Data</strong>: We can use the cenpy library to access Census data for Philadelphia. The variables of interest include total population, number of white residents, median household income, median contract rent, total living in poverty, and bachelor’s degree holders.</p>
<div id="f9e16f92" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>variables <span class="op">=</span> {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'B25026_001E'</span>: <span class="st">'TotalPop'</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'B02001_002E'</span>: <span class="st">'NumberWhites'</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'B15001_050E'</span>: <span class="st">'TotalFemaleBachelors'</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'B15001_009E'</span>: <span class="st">'TotalMaleBacheors'</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'B19013_001E'</span>: <span class="st">'MedHHInc'</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'B25058_001E'</span>: <span class="st">'MedRent'</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'B06012_002E'</span>: <span class="st">'TotalPoverty'</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="40da9d24" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>acs <span class="op">=</span> cp.remote.APIConnection(<span class="st">'ACSDT5Y2017'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="3ffe31f4" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>tiger.available()</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>acs.set_mapservice(<span class="st">'tigerWMS_ACS2017'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>Connection to ACS 5-Year Detailed Tables(ID: https://api.census.gov/data/id/ACSDT5Y2017)
With MapServer: Census ACS 2017 WMS</code></pre>
</div>
</div>
<div id="947430c8" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>acs.mapservice</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>acs.mapservice.layers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>[(ESRILayer) 2010 Census Public Use Microdata Areas,
 (ESRILayer) 2010 Census Public Use Microdata Areas Labels,
 (ESRILayer) 2010 Census ZIP Code Tabulation Areas,
 (ESRILayer) 2010 Census ZIP Code Tabulation Areas Labels,
 (ESRILayer) Tribal Census Tracts,
 (ESRILayer) Tribal Census Tracts Labels,
 (ESRILayer) Tribal Block Groups,
 (ESRILayer) Tribal Block Groups Labels,
 (ESRILayer) Census Tracts,
 (ESRILayer) Census Tracts Labels,
 (ESRILayer) Census Block Groups,
 (ESRILayer) Census Block Groups Labels,
 (ESRILayer) Unified School Districts,
 (ESRILayer) Unified School Districts Labels,
 (ESRILayer) Secondary School Districts,
 (ESRILayer) Secondary School Districts Labels,
 (ESRILayer) Elementary School Districts,
 (ESRILayer) Elementary School Districts Labels,
 (ESRILayer) Estates,
 (ESRILayer) Estates Labels,
 (ESRILayer) County Subdivisions,
 (ESRILayer) County Subdivisions Labels,
 (ESRILayer) Subbarrios,
 (ESRILayer) Subbarrios Labels,
 (ESRILayer) Consolidated Cities,
 (ESRILayer) Consolidated Cities Labels,
 (ESRILayer) Incorporated Places,
 (ESRILayer) Incorporated Places Labels,
 (ESRILayer) Census Designated Places,
 (ESRILayer) Census Designated Places Labels,
 (ESRILayer) Alaska Native Regional Corporations,
 (ESRILayer) Alaska Native Regional Corporations Labels,
 (ESRILayer) Tribal Subdivisions,
 (ESRILayer) Tribal Subdivisions Labels,
 (ESRILayer) Federal American Indian Reservations,
 (ESRILayer) Federal American Indian Reservations Labels,
 (ESRILayer) Off-Reservation Trust Lands,
 (ESRILayer) Off-Reservation Trust Lands Labels,
 (ESRILayer) State American Indian Reservations,
 (ESRILayer) State American Indian Reservations Labels,
 (ESRILayer) Hawaiian Home Lands,
 (ESRILayer) Hawaiian Home Lands Labels,
 (ESRILayer) Alaska Native Village Statistical Areas,
 (ESRILayer) Alaska Native Village Statistical Areas Labels,
 (ESRILayer) Oklahoma Tribal Statistical Areas,
 (ESRILayer) Oklahoma Tribal Statistical Areas Labels,
 (ESRILayer) State Designated Tribal Statistical Areas,
 (ESRILayer) State Designated Tribal Statistical Areas Labels,
 (ESRILayer) Tribal Designated Statistical Areas,
 (ESRILayer) Tribal Designated Statistical Areas Labels,
 (ESRILayer) American Indian Joint-Use Areas,
 (ESRILayer) American Indian Joint-Use Areas Labels,
 (ESRILayer) 115th Congressional Districts,
 (ESRILayer) 115th Congressional Districts Labels,
 (ESRILayer) 2016 State Legislative Districts - Upper,
 (ESRILayer) 2016 State Legislative Districts - Upper Labels,
 (ESRILayer) 2016 State Legislative Districts - Lower,
 (ESRILayer) 2016 State Legislative Districts - Lower Labels,
 (ESRILayer) Census Divisions,
 (ESRILayer) Census Divisions Labels,
 (ESRILayer) Census Regions,
 (ESRILayer) Census Regions Labels,
 (ESRILayer) 2010 Census Urbanized Areas,
 (ESRILayer) 2010 Census Urbanized Areas Labels,
 (ESRILayer) 2010 Census Urban Clusters,
 (ESRILayer) 2010 Census Urban Clusters Labels,
 (ESRILayer) Combined New England City and Town Areas,
 (ESRILayer) Combined New England City and Town Areas Labels,
 (ESRILayer) New England City and Town Area Divisions,
 (ESRILayer) New England City and Town Area  Divisions Labels,
 (ESRILayer) Metropolitan New England City and Town Areas,
 (ESRILayer) Metropolitan New England City and Town Areas Labels,
 (ESRILayer) Micropolitan New England City and Town Areas,
 (ESRILayer) Micropolitan New England City and Town Areas Labels,
 (ESRILayer) Combined Statistical Areas,
 (ESRILayer) Combined Statistical Areas Labels,
 (ESRILayer) Metropolitan Divisions,
 (ESRILayer) Metropolitan Divisions Labels,
 (ESRILayer) Metropolitan Statistical Areas,
 (ESRILayer) Metropolitan Statistical Areas Labels,
 (ESRILayer) Micropolitan Statistical Areas,
 (ESRILayer) Micropolitan Statistical Areas Labels,
 (ESRILayer) States,
 (ESRILayer) States Labels,
 (ESRILayer) Counties,
 (ESRILayer) Counties Labels]</code></pre>
</div>
</div>
<div id="9d66d9a5" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>acs.mapservice.layers[<span class="dv">8</span>]</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>acs.mapservice.layers[<span class="dv">8</span>].variables</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>geodata <span class="op">=</span> acs.mapservice.query(layer<span class="op">=</span><span class="dv">8</span>, where<span class="op">=</span><span class="st">"STATE = '42' AND COUNTY = '101'"</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>geodata.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MTFCC</th>
<th data-quarto-table-cell-role="th">OID</th>
<th data-quarto-table-cell-role="th">GEOID</th>
<th data-quarto-table-cell-role="th">STATE</th>
<th data-quarto-table-cell-role="th">COUNTY</th>
<th data-quarto-table-cell-role="th">TRACT</th>
<th data-quarto-table-cell-role="th">BASENAME</th>
<th data-quarto-table-cell-role="th">NAME</th>
<th data-quarto-table-cell-role="th">LSADC</th>
<th data-quarto-table-cell-role="th">FUNCSTAT</th>
<th data-quarto-table-cell-role="th">AREALAND</th>
<th data-quarto-table-cell-role="th">AREAWATER</th>
<th data-quarto-table-cell-role="th">CENTLAT</th>
<th data-quarto-table-cell-role="th">CENTLON</th>
<th data-quarto-table-cell-role="th">INTPTLAT</th>
<th data-quarto-table-cell-role="th">INTPTLON</th>
<th data-quarto-table-cell-role="th">OBJECTID</th>
<th data-quarto-table-cell-role="th">geometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>G5020</td>
<td>20790510128341</td>
<td>42101000100</td>
<td>42</td>
<td>101</td>
<td>000100</td>
<td>1</td>
<td>Census Tract 1</td>
<td>CT</td>
<td>S</td>
<td>704917</td>
<td>0</td>
<td>+39.9523827</td>
<td>-075.1466629</td>
<td>+39.9523827</td>
<td>-075.1466629</td>
<td>40975</td>
<td>POLYGON ((-8365905.972 4858674.427, -8365885.3...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>G5020</td>
<td>20790510128392</td>
<td>42101000200</td>
<td>42</td>
<td>101</td>
<td>000200</td>
<td>2</td>
<td>Census Tract 2</td>
<td>CT</td>
<td>S</td>
<td>382481</td>
<td>0</td>
<td>+39.9553999</td>
<td>-075.1569774</td>
<td>+39.9553999</td>
<td>-075.1569774</td>
<td>40976</td>
<td>POLYGON ((-8367094.196 4859452.933, -8367072.1...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>G5020</td>
<td>20790510128432</td>
<td>42101000300</td>
<td>42</td>
<td>101</td>
<td>000300</td>
<td>3</td>
<td>Census Tract 3</td>
<td>CT</td>
<td>S</td>
<td>546270</td>
<td>22680</td>
<td>+39.9571482</td>
<td>-075.1712337</td>
<td>+39.9569074</td>
<td>-075.1712767</td>
<td>40977</td>
<td>POLYGON ((-8368992.305 4860135.356, -8368934.1...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>G5020</td>
<td>207903717001433</td>
<td>42101000401</td>
<td>42</td>
<td>101</td>
<td>000401</td>
<td>4.01</td>
<td>Census Tract 4.01</td>
<td>CT</td>
<td>S</td>
<td>216838</td>
<td>15884</td>
<td>+39.9541571</td>
<td>-075.1765866</td>
<td>+39.9541871</td>
<td>-075.1758082</td>
<td>5715</td>
<td>POLYGON ((-8369100.507 4859112.102, -8369024.1...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>G5020</td>
<td>207903717001432</td>
<td>42101000402</td>
<td>42</td>
<td>101</td>
<td>000402</td>
<td>4.02</td>
<td>Census Tract 4.02</td>
<td>CT</td>
<td>S</td>
<td>303681</td>
<td>0</td>
<td>+39.9532973</td>
<td>-075.1686952</td>
<td>+39.9532973</td>
<td>-075.1686952</td>
<td>18311</td>
<td>POLYGON ((-8368261.381 4859050.821, -8368260.4...</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="8f5fdf48" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>geodata.plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="TOD_files/figure-html/cell-8-output-1.png" width="407" height="442" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="be55e9c9" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>acs.variables.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">label</th>
<th data-quarto-table-cell-role="th">concept</th>
<th data-quarto-table-cell-role="th">predicateType</th>
<th data-quarto-table-cell-role="th">group</th>
<th data-quarto-table-cell-role="th">limit</th>
<th data-quarto-table-cell-role="th">predicateOnly</th>
<th data-quarto-table-cell-role="th">hasGeoCollectionSupport</th>
<th data-quarto-table-cell-role="th">attributes</th>
<th data-quarto-table-cell-role="th">required</th>
<th data-quarto-table-cell-role="th">values</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">for</td>
<td>Census API FIPS 'for' clause</td>
<td>Census API Geography Specification</td>
<td>fips-for</td>
<td>N/A</td>
<td>0</td>
<td>True</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">in</td>
<td>Census API FIPS 'in' clause</td>
<td>Census API Geography Specification</td>
<td>fips-in</td>
<td>N/A</td>
<td>0</td>
<td>True</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ucgid</td>
<td>Uniform Census Geography Identifier clause</td>
<td>Census API Geography Specification</td>
<td>ucgid</td>
<td>N/A</td>
<td>0</td>
<td>True</td>
<td>True</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">B24022_060E</td>
<td>Estimate!!Total!!Female!!Service occupations!!...</td>
<td>SEX BY OCCUPATION AND MEDIAN EARNINGS IN THE P...</td>
<td>int</td>
<td>B24022</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>B24022_060EA,B24022_060M,B24022_060MA</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">B19001B_014E</td>
<td>Estimate!!Total!!$100,000 to $124,999</td>
<td>HOUSEHOLD INCOME IN THE PAST 12 MONTHS (IN 201...</td>
<td>int</td>
<td>B19001B</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>B19001B_014EA,B19001B_014M,B19001B_014MA</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="95fb1593" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>acs.geographies[<span class="st">'fips'</span>].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">geoLevelDisplay</th>
<th data-quarto-table-cell-role="th">referenceDate</th>
<th data-quarto-table-cell-role="th">requires</th>
<th data-quarto-table-cell-role="th">wildcard</th>
<th data-quarto-table-cell-role="th">optionalWithWCFor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>us</td>
<td>010</td>
<td>2017-01-01</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>region</td>
<td>020</td>
<td>2017-01-01</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>division</td>
<td>030</td>
<td>2017-01-01</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>state</td>
<td>040</td>
<td>2017-01-01</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>county</td>
<td>050</td>
<td>2017-01-01</td>
<td>[state]</td>
<td>[state]</td>
<td>state</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="4dced964" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(variables.keys())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>['B25026_001E',
 'B02001_002E',
 'B15001_050E',
 'B15001_009E',
 'B19013_001E',
 'B25058_001E',
 'B06012_002E']</code></pre>
</div>
</div>
<div id="85eed4e8" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> acs.query(cols<span class="op">=</span> <span class="bu">list</span>(variables.keys())</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>, geo_unit <span class="op">=</span> <span class="st">'tract:*'</span>,  geo_filter <span class="op">=</span> {<span class="st">'state'</span>:<span class="st">'42'</span> , <span class="st">'county'</span>:<span class="st">'101'</span>})</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">B25026_001E</th>
<th data-quarto-table-cell-role="th">B02001_002E</th>
<th data-quarto-table-cell-role="th">B15001_050E</th>
<th data-quarto-table-cell-role="th">B15001_009E</th>
<th data-quarto-table-cell-role="th">B19013_001E</th>
<th data-quarto-table-cell-role="th">B25058_001E</th>
<th data-quarto-table-cell-role="th">B06012_002E</th>
<th data-quarto-table-cell-role="th">state</th>
<th data-quarto-table-cell-role="th">county</th>
<th data-quarto-table-cell-role="th">tract</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>6705</td>
<td>458</td>
<td>33</td>
<td>0</td>
<td>33344</td>
<td>671</td>
<td>2153</td>
<td>42</td>
<td>101</td>
<td>006700</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>3178</td>
<td>90</td>
<td>12</td>
<td>0</td>
<td>28264</td>
<td>638</td>
<td>770</td>
<td>42</td>
<td>101</td>
<td>007000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>4095</td>
<td>917</td>
<td>69</td>
<td>7</td>
<td>40947</td>
<td>845</td>
<td>1101</td>
<td>42</td>
<td>101</td>
<td>008000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4152</td>
<td>51</td>
<td>45</td>
<td>0</td>
<td>17149</td>
<td>379</td>
<td>1821</td>
<td>42</td>
<td>101</td>
<td>009400</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>3135</td>
<td>182</td>
<td>0</td>
<td>7</td>
<td>21788</td>
<td>644</td>
<td>1195</td>
<td>42</td>
<td>101</td>
<td>009500</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">379</td>
<td>7304</td>
<td>5189</td>
<td>82</td>
<td>21</td>
<td>43804</td>
<td>710</td>
<td>1321</td>
<td>42</td>
<td>101</td>
<td>033600</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">380</td>
<td>6279</td>
<td>5666</td>
<td>16</td>
<td>16</td>
<td>63750</td>
<td>1043</td>
<td>358</td>
<td>42</td>
<td>101</td>
<td>036303</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">381</td>
<td>2197</td>
<td>1527</td>
<td>28</td>
<td>10</td>
<td>109609</td>
<td>2181</td>
<td>106</td>
<td>42</td>
<td>101</td>
<td>036600</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">382</td>
<td>4328</td>
<td>1591</td>
<td>9</td>
<td>0</td>
<td>19656</td>
<td>547</td>
<td>2133</td>
<td>42</td>
<td>101</td>
<td>029900</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">383</td>
<td>4801</td>
<td>140</td>
<td>0</td>
<td>0</td>
<td>26232</td>
<td>349</td>
<td>1432</td>
<td>42</td>
<td>101</td>
<td>027700</td>
</tr>
</tbody>
</table>

<p>384 rows × 10 columns</p>
</div>
</div>
</div>
</div>
<div id="52f885fb" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>geodata.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>Index(['MTFCC', 'OID', 'GEOID', 'STATE', 'COUNTY', 'TRACT', 'BASENAME', 'NAME',
       'LSADC', 'FUNCSTAT', 'AREALAND', 'AREAWATER', 'CENTLAT', 'CENTLON',
       'INTPTLAT', 'INTPTLON', 'OBJECTID', 'geometry'],
      dtype='object')</code></pre>
</div>
</div>
<div id="936bfbc6" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>data.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>Index(['B25026_001E', 'B02001_002E', 'B15001_050E', 'B15001_009E',
       'B19013_001E', 'B25058_001E', 'B06012_002E', 'state', 'county',
       'tract'],
      dtype='object')</code></pre>
</div>
</div>
<p>Now, we are going to append geodata to census data.</p>
<div id="4db8b412" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>tract17 <span class="op">=</span> pd.merge(data, geodata, left_on<span class="op">=</span><span class="st">'tract'</span>, right_on<span class="op">=</span><span class="st">'TRACT'</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>tract17.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">B25026_001E</th>
<th data-quarto-table-cell-role="th">B02001_002E</th>
<th data-quarto-table-cell-role="th">B15001_050E</th>
<th data-quarto-table-cell-role="th">B15001_009E</th>
<th data-quarto-table-cell-role="th">B19013_001E</th>
<th data-quarto-table-cell-role="th">B25058_001E</th>
<th data-quarto-table-cell-role="th">B06012_002E</th>
<th data-quarto-table-cell-role="th">state</th>
<th data-quarto-table-cell-role="th">county</th>
<th data-quarto-table-cell-role="th">tract</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">LSADC</th>
<th data-quarto-table-cell-role="th">FUNCSTAT</th>
<th data-quarto-table-cell-role="th">AREALAND</th>
<th data-quarto-table-cell-role="th">AREAWATER</th>
<th data-quarto-table-cell-role="th">CENTLAT</th>
<th data-quarto-table-cell-role="th">CENTLON</th>
<th data-quarto-table-cell-role="th">INTPTLAT</th>
<th data-quarto-table-cell-role="th">INTPTLON</th>
<th data-quarto-table-cell-role="th">OBJECTID</th>
<th data-quarto-table-cell-role="th">geometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>6705</td>
<td>458</td>
<td>33</td>
<td>0</td>
<td>33344</td>
<td>671</td>
<td>2153</td>
<td>42</td>
<td>101</td>
<td>006700</td>
<td>...</td>
<td>CT</td>
<td>S</td>
<td>1001468</td>
<td>0</td>
<td>+39.9242475</td>
<td>-075.2242816</td>
<td>+39.9242475</td>
<td>-075.2242816</td>
<td>7609</td>
<td>POLYGON ((-8374836.689 4854899.950, -8374750.9...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>3178</td>
<td>90</td>
<td>12</td>
<td>0</td>
<td>28264</td>
<td>638</td>
<td>770</td>
<td>42</td>
<td>101</td>
<td>007000</td>
<td>...</td>
<td>CT</td>
<td>S</td>
<td>469047</td>
<td>0</td>
<td>+39.9351850</td>
<td>-075.2214770</td>
<td>+39.9351850</td>
<td>-075.2214770</td>
<td>33751</td>
<td>POLYGON ((-8374204.728 4856502.019, -8374162.0...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>4095</td>
<td>917</td>
<td>69</td>
<td>7</td>
<td>40947</td>
<td>845</td>
<td>1101</td>
<td>42</td>
<td>101</td>
<td>008000</td>
<td>...</td>
<td>CT</td>
<td>S</td>
<td>430891</td>
<td>0</td>
<td>+39.9506586</td>
<td>-075.2268464</td>
<td>+39.9506586</td>
<td>-075.2268464</td>
<td>28038</td>
<td>POLYGON ((-8374706.223 4858379.218, -8374705.7...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4152</td>
<td>51</td>
<td>45</td>
<td>0</td>
<td>17149</td>
<td>379</td>
<td>1821</td>
<td>42</td>
<td>101</td>
<td>009400</td>
<td>...</td>
<td>CT</td>
<td>S</td>
<td>366714</td>
<td>0</td>
<td>+39.9632709</td>
<td>-075.2322437</td>
<td>+39.9632709</td>
<td>-075.2322437</td>
<td>59933</td>
<td>POLYGON ((-8375308.573 4860435.266, -8375304.4...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>3135</td>
<td>182</td>
<td>0</td>
<td>7</td>
<td>21788</td>
<td>644</td>
<td>1195</td>
<td>42</td>
<td>101</td>
<td>009500</td>
<td>...</td>
<td>CT</td>
<td>S</td>
<td>319096</td>
<td>0</td>
<td>+39.9658712</td>
<td>-075.2379141</td>
<td>+39.9658712</td>
<td>-075.2379141</td>
<td>59934</td>
<td>POLYGON ((-8375726.132 4860644.844, -8375690.7...</td>
</tr>
</tbody>
</table>

<p>5 rows × 28 columns</p>
</div>
</div>
</div>
</div>
<div id="bf7957c3" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>tract17.rename(columns<span class="op">=</span>variables, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>tract17</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">TotalPop</th>
<th data-quarto-table-cell-role="th">NumberWhites</th>
<th data-quarto-table-cell-role="th">TotalFemaleBachelors</th>
<th data-quarto-table-cell-role="th">TotalMaleBacheors</th>
<th data-quarto-table-cell-role="th">MedHHInc</th>
<th data-quarto-table-cell-role="th">MedRent</th>
<th data-quarto-table-cell-role="th">TotalPoverty</th>
<th data-quarto-table-cell-role="th">state</th>
<th data-quarto-table-cell-role="th">county</th>
<th data-quarto-table-cell-role="th">tract</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">LSADC</th>
<th data-quarto-table-cell-role="th">FUNCSTAT</th>
<th data-quarto-table-cell-role="th">AREALAND</th>
<th data-quarto-table-cell-role="th">AREAWATER</th>
<th data-quarto-table-cell-role="th">CENTLAT</th>
<th data-quarto-table-cell-role="th">CENTLON</th>
<th data-quarto-table-cell-role="th">INTPTLAT</th>
<th data-quarto-table-cell-role="th">INTPTLON</th>
<th data-quarto-table-cell-role="th">OBJECTID</th>
<th data-quarto-table-cell-role="th">geometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>6705</td>
<td>458</td>
<td>33</td>
<td>0</td>
<td>33344</td>
<td>671</td>
<td>2153</td>
<td>42</td>
<td>101</td>
<td>006700</td>
<td>...</td>
<td>CT</td>
<td>S</td>
<td>1001468</td>
<td>0</td>
<td>+39.9242475</td>
<td>-075.2242816</td>
<td>+39.9242475</td>
<td>-075.2242816</td>
<td>7609</td>
<td>POLYGON ((-8374836.689 4854899.950, -8374750.9...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>3178</td>
<td>90</td>
<td>12</td>
<td>0</td>
<td>28264</td>
<td>638</td>
<td>770</td>
<td>42</td>
<td>101</td>
<td>007000</td>
<td>...</td>
<td>CT</td>
<td>S</td>
<td>469047</td>
<td>0</td>
<td>+39.9351850</td>
<td>-075.2214770</td>
<td>+39.9351850</td>
<td>-075.2214770</td>
<td>33751</td>
<td>POLYGON ((-8374204.728 4856502.019, -8374162.0...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>4095</td>
<td>917</td>
<td>69</td>
<td>7</td>
<td>40947</td>
<td>845</td>
<td>1101</td>
<td>42</td>
<td>101</td>
<td>008000</td>
<td>...</td>
<td>CT</td>
<td>S</td>
<td>430891</td>
<td>0</td>
<td>+39.9506586</td>
<td>-075.2268464</td>
<td>+39.9506586</td>
<td>-075.2268464</td>
<td>28038</td>
<td>POLYGON ((-8374706.223 4858379.218, -8374705.7...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4152</td>
<td>51</td>
<td>45</td>
<td>0</td>
<td>17149</td>
<td>379</td>
<td>1821</td>
<td>42</td>
<td>101</td>
<td>009400</td>
<td>...</td>
<td>CT</td>
<td>S</td>
<td>366714</td>
<td>0</td>
<td>+39.9632709</td>
<td>-075.2322437</td>
<td>+39.9632709</td>
<td>-075.2322437</td>
<td>59933</td>
<td>POLYGON ((-8375308.573 4860435.266, -8375304.4...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>3135</td>
<td>182</td>
<td>0</td>
<td>7</td>
<td>21788</td>
<td>644</td>
<td>1195</td>
<td>42</td>
<td>101</td>
<td>009500</td>
<td>...</td>
<td>CT</td>
<td>S</td>
<td>319096</td>
<td>0</td>
<td>+39.9658712</td>
<td>-075.2379141</td>
<td>+39.9658712</td>
<td>-075.2379141</td>
<td>59934</td>
<td>POLYGON ((-8375726.132 4860644.844, -8375690.7...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">379</td>
<td>7304</td>
<td>5189</td>
<td>82</td>
<td>21</td>
<td>43804</td>
<td>710</td>
<td>1321</td>
<td>42</td>
<td>101</td>
<td>033600</td>
<td>...</td>
<td>CT</td>
<td>S</td>
<td>1153477</td>
<td>0</td>
<td>+40.0614797</td>
<td>-075.0592347</td>
<td>+40.0614797</td>
<td>-075.0592347</td>
<td>33748</td>
<td>POLYGON ((-8356539.773 4874784.998, -8356411.7...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">380</td>
<td>6279</td>
<td>5666</td>
<td>16</td>
<td>16</td>
<td>63750</td>
<td>1043</td>
<td>358</td>
<td>42</td>
<td>101</td>
<td>036303</td>
<td>...</td>
<td>CT</td>
<td>S</td>
<td>2555016</td>
<td>0</td>
<td>+40.1051803</td>
<td>-074.9702251</td>
<td>+40.1051803</td>
<td>-074.9702251</td>
<td>22366</td>
<td>POLYGON ((-8347015.945 4881106.829, -8346996.7...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">381</td>
<td>2197</td>
<td>1527</td>
<td>28</td>
<td>10</td>
<td>109609</td>
<td>2181</td>
<td>106</td>
<td>42</td>
<td>101</td>
<td>036600</td>
<td>...</td>
<td>CT</td>
<td>S</td>
<td>1004520</td>
<td>1426274</td>
<td>+39.9448587</td>
<td>-075.1389514</td>
<td>+39.9469291</td>
<td>-075.1404797</td>
<td>72014</td>
<td>POLYGON ((-8365255.643 4855808.086, -8365233.3...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">382</td>
<td>4328</td>
<td>1591</td>
<td>9</td>
<td>0</td>
<td>19656</td>
<td>547</td>
<td>2133</td>
<td>42</td>
<td>101</td>
<td>029900</td>
<td>...</td>
<td>CT</td>
<td>S</td>
<td>591446</td>
<td>0</td>
<td>+40.0131465</td>
<td>-075.0747147</td>
<td>+40.0131465</td>
<td>-075.0747147</td>
<td>57263</td>
<td>POLYGON ((-8357962.770 4867672.142, -8357888.0...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">383</td>
<td>4801</td>
<td>140</td>
<td>0</td>
<td>0</td>
<td>26232</td>
<td>349</td>
<td>1432</td>
<td>42</td>
<td>101</td>
<td>027700</td>
<td>...</td>
<td>CT</td>
<td>S</td>
<td>543124</td>
<td>0</td>
<td>+40.0505407</td>
<td>-075.1512097</td>
<td>+40.0505407</td>
<td>-075.1512097</td>
<td>71681</td>
<td>POLYGON ((-8366544.612 4873096.939, -8366541.1...</td>
</tr>
</tbody>
</table>

<p>384 rows × 28 columns</p>
</div>
</div>
</div>
</div>
<div id="99846179" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>tract17<span class="op">=</span>gpd.GeoDataFrame(tract17, geometry<span class="op">=</span><span class="st">'geometry'</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>tract17.plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="TOD_files/figure-html/cell-17-output-1.png" width="407" height="442" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p><strong>Data Wrangling</strong>: We can use pandas to manipulate the data, such as renaming columns, calculating rates, and adjusting for inflation.</p>
</section>
<section id="transit-open-data-download-and-wrangle" class="level3">
<h3 class="anchored" data-anchor-id="transit-open-data-download-and-wrangle">1.2.2 Transit Open Data: Download and Wrangle</h3>
<p><strong>Accessing Transit Data</strong>: Suppose we have a GeoJSON file with the locations of subway stops in Philadelphia. We can use geopandas to read this data.</p>
<div id="ab20b04c" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>septa_stops <span class="op">=</span> gpd.read_file(<span class="st">"https://raw.githubusercontent.com/urbanSpatial/Public-Policy-Analytics-Landing/0c6e18b06d1675858dff1741a9e4a363bfa761db/DATA/Chapter1/PHL_CT00.geojson"</span>, geometry<span class="op">=</span><span class="st">'geometry'</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(septa_stops.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         GEOID            NAME   variable    value  \
0  42101000100  Census Tract 1    P001001   2576.0   
1  42101000100  Census Tract 1    P006002   2095.0   
2  42101000100  Census Tract 1  PCT025050     48.0   
3  42101000100  Census Tract 1  PCT025009     64.0   
4  42101000100  Census Tract 1    P053001  48886.0   

                                            geometry  
0  MULTIPOLYGON (((-75.14882 39.95631, -75.14792 ...  
1  MULTIPOLYGON (((-75.14882 39.95631, -75.14792 ...  
2  MULTIPOLYGON (((-75.14882 39.95631, -75.14792 ...  
3  MULTIPOLYGON (((-75.14882 39.95631, -75.14792 ...  
4  MULTIPOLYGON (((-75.14882 39.95631, -75.14792 ...  </code></pre>
</div>
</div>
<div id="a0fee156" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>septa_stops.plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="TOD_files/figure-html/cell-19-output-1.png" width="420" height="415" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="relating-tracts-subway-stops-in-space" class="level3">
<h3 class="anchored" data-anchor-id="relating-tracts-subway-stops-in-space">1.2.3 Relating Tracts &amp; Subway Stops in Space</h3>
<p>We can use geopandas to perform spatial operations such as buffering, intersection, and spatial joins to relate Census tracts to subway stops.</p>
<div id="8b7e2709" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>buffered_stops <span class="op">=</span> septa_stops.<span class="bu">buffer</span>(<span class="dv">2640</span>)  <span class="co"># Buffer in feet</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>buffered_stops.head</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/ls/4rhr7kfj5nd_v0fn499s11hm0000gn/T/ipykernel_48621/543701200.py:1: UserWarning:

Geometry is in a geographic CRS. Results from 'buffer' are likely incorrect. Use 'GeoSeries.to_crs()' to re-project geometries to a projected CRS before this operation.

</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>&lt;bound method NDFrame.head of 0       POLYGON ((175.14718 2668.06436, 199.92679 2664...
1       POLYGON ((175.14718 2668.06436, 199.92679 2664...
2       POLYGON ((175.14718 2668.06436, 199.92679 2664...
3       POLYGON ((175.14718 2668.06436, 199.92679 2664...
4       POLYGON ((175.14718 2668.06436, 199.92679 2664...
                              ...                        
2662    POLYGON ((-2598.72985 810.29345, -2600.12020 8...
2663    POLYGON ((-2598.72985 810.29345, -2600.12020 8...
2664    POLYGON ((-2598.72985 810.29345, -2600.12020 8...
2665    POLYGON ((-2598.72985 810.29345, -2600.12020 8...
2666    POLYGON ((-2598.72985 810.29345, -2600.12020 8...
Length: 2667, dtype: geometry&gt;</code></pre>
</div>
</div>
<p>tracts_near_stops = gpd.sjoin(census_data, buffered_stops, op=‘intersects’)</p>
<p>tracts_near_stops.head()</p>
<p>```</p>


</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>The ecological fallacy is a logical error that occurs when conclusions about individual behavior are drawn from aggregate data. It happens when researchers make inferences about the behavior or characteristics of individuals based on data that has been collected and analyzed at a group level, such as census tracts, neighborhoods, or countries.</p>
<p>For example, if data shows that a particular neighborhood has a high average income, it would be an ecological fallacy to assume that every individual in that neighborhood is wealthy. In reality, the neighborhood might have a mix of income levels, but the average is skewed by a few very high-income residents.</p>
<p>The ecological fallacy highlights the importance of being cautious when interpreting aggregate data and not making unwarranted assumptions about individual characteristics or behaviors based on group-level statistics.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/gigisung0503\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© CC-Gigi Sung, 2024</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/gigisung0503/gigisung0503.github.io.git/blob/main/Policy Analysis/Chapter1/TOD.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>All rights reserved. 2024.</p>
</div>
  </div>
</footer>




</body></html>